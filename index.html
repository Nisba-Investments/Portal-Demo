<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NISBA - Halal Investment Platform Demo</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
  <script type="text/javascript">(function(w,s){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="https://cdn-eu.pagesense.io/js/canvigroup131/eca4cfb85b8d4b93a30df9b8231b822c.js";var x=document.getElementsByTagName("script")[0];x.parentNode.insertBefore(e,x);})(window,"script");</script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #1e3a8a;
            --secondary-blue: #3b82f6;
            --accent-gold: #f59e0b;
            --light-blue: #eff6ff;
            --dark-blue: #1e1b4b;
            --warm-gray: #374151;
            --light-gray: #9ca3af;
            --white: #ffffff;
            --success-green: #10b981;
            --gradient: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            --shadow: 0 10px 30px rgba(30, 58, 138, 0.1);
            --shadow-hover: 0 15px 40px rgba(30, 58, 138, 0.2);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--warm-gray);
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .header {
            background: var(--white);
            box-shadow: var(--shadow);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--warm-gray);
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: var(--primary-blue);
        }

        .demo-badge {
            background: var(--accent-gold);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* Login Portal Styles */
        .login-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
            min-height: calc(100vh - 140px);
            padding: 2rem 0;
        }

        .login-card {
            background: var(--white);
            padding: 3rem;
            border-radius: 20px;
            box-shadow: var(--shadow-hover);
            max-width: 450px;
            margin: 0 auto;
        }

        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .logo-large {
            font-size: 3rem;
            font-weight: bold;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
        }

        .login-header h2 {
            font-size: 2rem;
            color: var(--warm-gray);
            margin-bottom: 0.5rem;
        }

        .login-header p {
            color: var(--light-gray);
            font-size: 1.1rem;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .form-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--light-gray);
            cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
            accent-color: var(--primary-blue);
        }

        .forgot-link {
            color: var(--primary-blue);
            text-decoration: none;
            font-weight: 500;
        }

        .forgot-link:hover {
            text-decoration: underline;
        }

        .login-btn {
            width: 100%;
            padding: 1rem;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }

        .divider {
            position: relative;
            text-align: center;
            margin: 1rem 0;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #E5E7EB;
        }

        .divider span {
            background: var(--white);
            color: var(--light-gray);
            padding: 0 1rem;
            font-size: 0.9rem;
        }

        .demo-accounts {
            background: #F8F9FA;
            padding: 1.5rem;
            border-radius: 15px;
            border: 1px solid #E5E7EB;
        }

        .demo-accounts h4 {
            margin: 0 0 0.5rem 0;
            color: var(--warm-gray);
            font-size: 1rem;
            text-align: center;
        }

        .demo-accounts p.demo-explanation {
            margin: 0 0 1rem 0;
            color: var(--light-gray);
            font-size: 0.9rem;
            text-align: center;
            line-height: 1.4;
        }

        .demo-account-grid {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .demo-account-btn {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--white);
            border: 2px solid #E5E7EB;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            width: 100%;
        }

        .demo-account-btn:hover {
            border-color: var(--primary-blue);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.1);
        }

        .demo-account-btn i {
            font-size: 1.5rem;
            color: var(--primary-blue);
            min-width: 24px;
        }

        .demo-account-btn span {
            font-weight: 600;
            color: var(--warm-gray);
            display: block;
            margin-bottom: 0.25rem;
        }

        .demo-account-btn small {
            color: var(--light-gray);
            font-size: 0.8rem;
        }

        .signup-link {
            text-align: center;
            color: var(--light-gray);
            font-size: 0.9rem;
        }

        .signup-link a {
            color: var(--primary-blue);
            text-decoration: none;
            font-weight: 500;
        }

        .signup-link a:hover {
            text-decoration: underline;
        }

        .login-features {
            padding: 2rem;
        }

        .login-features h3 {
            font-size: 2rem;
            color: var(--warm-gray);
            margin-bottom: 2rem;
            text-align: center;
        }

        .feature-list {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .feature-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .feature-item i {
            font-size: 1.5rem;
            color: var(--primary-blue);
            margin-top: 0.25rem;
            min-width: 24px;
        }

        .feature-item h4 {
            margin: 0 0 0.5rem 0;
            color: var(--warm-gray);
            font-size: 1.1rem;
        }

        .feature-item p {
            margin: 0;
            color: var(--light-gray);
            line-height: 1.5;
        }

        /* Offline Mode Styles */
        .offline-mode {
            position: relative;
        }

        .offline-mode::before {
            content: 'OFFLINE MODE';
            position: fixed;
            top: 80px;
            left: 20px;
            background: #EF4444;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            z-index: 1000;
        }

        /* Breadcrumb Navigation */
        .breadcrumb {
            margin-bottom: 2rem;
        }

        .breadcrumb-list {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .breadcrumb-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            opacity: 0.5;
            transition: all 0.3s ease;
        }

        .breadcrumb-item.active {
            opacity: 1;
        }

        .breadcrumb-item.completed {
            opacity: 0.8;
        }

        .breadcrumb-item::after {
            content: '';
            position: absolute;
            top: 15px;
            left: 50px;
            width: 40px;
            height: 2px;
            background: #E5E7EB;
            z-index: -1;
        }

        .breadcrumb-item:last-child::after {
            display: none;
        }

        .breadcrumb-item.completed::after {
            background: var(--primary-blue);
        }

        .breadcrumb-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #E5E7EB;
            color: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }

        .breadcrumb-item.active .breadcrumb-number {
            background: var(--primary-blue);
            color: white;
            transform: scale(1.1);
        }

        .breadcrumb-item.completed .breadcrumb-number {
            background: var(--success-green);
            color: white;
        }

        .breadcrumb-label {
            font-size: 0.8rem;
            color: var(--light-gray);
            text-align: center;
            transition: color 0.3s ease;
        }

        .breadcrumb-item.active .breadcrumb-label {
            color: var(--primary-blue);
            font-weight: 600;
        }

        /* Enhanced Mobile Touch Targets */
        @media (max-width: 768px) {
            .btn, .option-card, .demo-account-btn {
                min-height: 48px;
                min-width: 48px;
                padding: 1rem 1.5rem;
            }

            .btn-small {
                min-height: 40px;
                padding: 0.75rem 1.25rem;
            }

            .form-control {
                min-height: 48px;
                padding: 1rem;
                font-size: 1rem;
            }

            .option-card {
                padding: 2rem 1.5rem;
            }

            .client-item, .session-item {
                padding: 2rem;
                gap: 1.5rem;
            }

            .navigation-buttons .btn {
                padding: 1.25rem 2rem;
                font-size: 1.1rem;
            }
        }

        /* Search and Filter Styles */
        .card-header-with-search {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .search-container {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .search-box {
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-box i {
            position: absolute;
            left: 1rem;
            color: var(--light-gray);
            z-index: 2;
        }

        .search-box input {
            padding: 0.75rem 1rem 0.75rem 2.5rem;
            border: 2px solid #E5E7EB;
            border-radius: 25px;
            background: #F9FAFB;
            transition: all 0.3s ease;
            min-width: 200px;
        }

        .search-box input:focus {
            border-color: var(--primary-blue);
            background: white;
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }

        .filter-dropdown select {
            padding: 0.75rem 1rem;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            background: white;
            color: var(--warm-gray);
            cursor: pointer;
            transition: border-color 0.3s ease;
        }

        .filter-dropdown select:focus {
            border-color: var(--primary-blue);
            outline: none;
        }

        /* Tooltip System */
        .help-btn {
            background: none;
            border: none;
            color: var(--light-gray);
            cursor: pointer;
            padding: 0.25rem;
            margin-left: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .help-btn:hover {
            color: var(--primary-blue);
            background: var(--light-blue);
        }

        .tooltip {
            position: absolute;
            background: var(--warm-gray);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 0.8rem;
            max-width: 200px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            animation: fadeInUp 0.2s ease-out;
        }

        .tooltip::before {
            content: '';
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-bottom: 5px solid var(--warm-gray);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Form Help Text */
        .form-help {
            color: var(--light-gray);
            font-size: 0.8rem;
            margin-top: 0.25rem;
            display: block;
        }

        /* Enhanced Micro-interactions */
        .dashboard-card {
            position: relative;
            overflow: hidden;
        }

        .dashboard-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--primary-blue), transparent);
            transition: left 0.6s ease;
        }

        .dashboard-card:hover::before {
            left: 100%;
        }

        .btn {
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.4s ease, height 0.4s ease;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .option-card {
            position: relative;
            overflow: hidden;
        }

        .option-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(30, 58, 138, 0.05) 50%, transparent 70%);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .option-card:hover::after {
            transform: translateX(100%);
        }

        /* Pulse animation for new notifications */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .notification {
            animation: slideInRight 0.3s ease-out, pulse 0.8s ease-in-out 0.5s;
        }

        /* Loading state improvements */
        .btn:disabled {
            position: relative;
        }

        .btn:disabled::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Keyboard Navigation Focus Styles */
        .keyboard-navigation *:focus {
            outline: 3px solid var(--primary-blue);
            outline-offset: 2px;
        }

        .keyboard-navigation .btn:focus,
        .keyboard-navigation .option-card:focus,
        .keyboard-navigation .demo-account-btn:focus {
            outline: 3px solid var(--primary-blue);
            outline-offset: 2px;
            transform: translateY(-2px);
        }

        /* Hide focus outline for mouse users */
        *:focus {
            outline: none;
        }

        /* Enhanced focus for form controls */
        .keyboard-navigation .form-control:focus {
            outline: 3px solid var(--primary-blue);
            outline-offset: 2px;
        }

        /* Clickable Card Styles */
        .clickable-card {
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .clickable-card .card-action {
            margin-top: 1rem;
            color: var(--primary-blue);
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .clickable-card:hover .card-action {
            opacity: 1;
        }

        /* Investment Simulator Styles */
        .simulator-container, .screener-container, .session-container {
            padding: 2rem 0;
        }

        .simulator-header, .screener-header, .session-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .simulator-balance {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: var(--light-blue);
            padding: 1rem 1.5rem;
            border-radius: 10px;
        }

        .balance-label {
            color: var(--light-gray);
            font-weight: 600;
        }

        .balance-amount {
            color: var(--primary-blue);
            font-size: 1.5rem;
            font-weight: bold;
        }

        .simulator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 2rem;
        }

        .simulator-card, .filter-card {
            background: var(--white);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }

        .simulator-card h3 {
            margin: 0 0 1.5rem 0;
            color: var(--warm-gray);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .market-list, .portfolio-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .stock-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border: 1px solid #E5E7EB;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .stock-item:hover {
            border-color: var(--primary-blue);
            background: var(--light-blue);
        }

        .stock-item.selected {
            border-color: var(--primary-blue);
            background: var(--light-blue);
        }

        .stock-info strong {
            display: block;
            color: var(--warm-gray);
            font-size: 1.1rem;
        }

        .stock-info span {
            color: var(--light-gray);
            font-size: 0.9rem;
        }

        .halal-badge {
            display: inline-block;
            background: var(--success-green);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-top: 0.25rem;
        }

        .halal-badge.warning {
            background: #F59E0B;
        }

        .stock-price {
            text-align: right;
        }

        .price {
            display: block;
            font-weight: bold;
            color: var(--warm-gray);
        }

        .change {
            font-size: 0.9rem;
            font-weight: 600;
        }

        .change.positive {
            color: var(--success-green);
        }

        .change.negative {
            color: #EF4444;
        }

        .trading-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .selected-stock {
            background: var(--light-blue);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .cost-display {
            background: #F3F4F6;
            padding: 0.8rem;
            border-radius: 8px;
            font-weight: bold;
            color: var(--primary-blue);
            font-size: 1.1rem;
        }

        .no-selection, .empty-portfolio {
            text-align: center;
            color: var(--light-gray);
            padding: 2rem;
        }

        .no-selection i, .empty-portfolio i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Halal Screener Styles */
        .screener-filters {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .filter-item label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .results-count {
            color: var(--light-gray);
            font-weight: 600;
        }

        .stocks-table {
            background: var(--white);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .table-header, .table-row {
            display: grid;
            grid-template-columns: 80px 2fr 100px 100px 120px 100px;
            gap: 1rem;
            padding: 1rem;
            align-items: center;
        }

        .table-header {
            background: #F8F9FA;
            font-weight: bold;
            color: var(--warm-gray);
            border-bottom: 2px solid #E5E7EB;
        }

        .table-row {
            border-bottom: 1px solid #F3F4F6;
            transition: background 0.3s ease;
        }

        .table-row:hover {
            background: var(--light-blue);
        }

        .halal-approved {
            color: var(--success-green);
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* Live Session Styles */
        .session-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .client-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--warm-gray);
        }

        .session-status.live {
            background: #EF4444;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        .video-session {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            height: 70vh;
        }

        .video-area {
            position: relative;
            background: #1a1a1a;
            border-radius: 15px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .main-video {
            flex: 1;
            position: relative;
        }

        .video-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
        }

        .client-video {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
        }

        .video-placeholder i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.7;
        }

        .video-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 1rem;
            background: rgba(0, 0, 0, 0.8);
            padding: 1rem;
            border-radius: 25px;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:not(.end-call):not(.screen-share) {
            background: var(--primary-blue);
        }

        .control-btn.screen-share {
            background: var(--accent-gold);
            width: auto;
            padding: 0 1.5rem;
            border-radius: 25px;
            gap: 0.5rem;
        }

        .control-btn.end-call {
            background: #EF4444;
        }

        .control-btn:hover {
            transform: scale(1.1);
        }

        .coach-video {
            position: absolute;
            bottom: 80px;
            right: 20px;
            width: 200px;
            height: 150px;
            background: var(--warm-gray);
            border-radius: 10px;
            overflow: hidden;
        }

        .coach-video .video-placeholder {
            background: var(--warm-gray);
        }

        .coach-video .video-placeholder h4 {
            font-size: 0.9rem;
            margin: 0.5rem 0 0 0;
        }

        .coach-video .video-placeholder p {
            font-size: 0.7rem;
            margin: 0;
        }

        .coach-video .video-placeholder i {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .session-tools {
            background: var(--white);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .tool-tabs {
            display: flex;
            background: #F8F9FA;
            border-bottom: 2px solid #E5E7EB;
        }

        .tool-tab {
            flex: 1;
            padding: 1rem;
            border: none;
            background: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
        }

        .tool-tab.active {
            background: var(--white);
            color: var(--primary-blue);
            border-bottom: 3px solid var(--primary-blue);
        }

        .tool-content {
            padding: 2rem;
            height: calc(70vh - 80px);
            overflow-y: auto;
        }

        .tool-panel {
            display: none;
        }

        .tool-panel.active {
            display: block;
        }

        .portfolio-metrics {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .metric-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem;
            background: #F8F9FA;
            border-radius: 8px;
        }

        .metric-label {
            color: var(--light-gray);
        }

        .metric-value {
            font-weight: bold;
            color: var(--warm-gray);
        }

        .metric-value.positive {
            color: var(--success-green);
        }

        .recommendations ul {
            margin: 0;
            padding-left: 1.5rem;
        }

        .recommendations li {
            margin-bottom: 0.5rem;
            color: var(--light-gray);
        }

        .goal-item {
            background: #F8F9FA;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .goal-progress {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-blue);
        }

        .resource-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .resource-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: #F8F9FA;
            border-radius: 8px;
        }

        .resource-item i {
            color: var(--primary-blue);
            font-size: 1.2rem;
        }

        .session-notes {
            width: 100%;
            min-height: 200px;
            padding: 1rem;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 1rem;
        }

        .session-notes:focus {
            border-color: var(--primary-blue);
            outline: none;
        }

        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .simulator-grid {
                grid-template-columns: 1fr 1fr;
            }

            .video-session {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .session-tools {
                height: auto;
            }

            .tool-content {
                height: auto;
            }
        }

        @media (max-width: 768px) {
            .simulator-grid {
                grid-template-columns: 1fr;
            }

            .screener-filters {
                grid-template-columns: 1fr;
            }

            .table-header, .table-row {
                grid-template-columns: 1fr;
                gap: 0.5rem;
                text-align: left;
            }

            .table-header div::before,
            .table-row div::before {
                content: attr(data-label) ': ';
                font-weight: bold;
                color: var(--primary-blue);
            }

            .tool-tabs {
                flex-wrap: wrap;
            }

            .tool-tab {
                flex: 1 1 50%;
            }

            .coach-video {
                position: relative;
                bottom: auto;
                right: auto;
                width: 100%;
                height: 200px;
                margin-top: 1rem;
            }
        }

        /* Main Content */
        .main {
            margin-top: 80px;
            padding: 2rem 0;
        }

        .screen {
            display: none;
            min-height: calc(100vh - 140px);
            animation: fadeIn 0.5s ease-in-out;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            padding: 4rem 0;
        }

        .hero-content h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero-content p {
            font-size: 1.2rem;
            color: var(--text-light);
            margin-bottom: 3rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .demo-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .demo-card {
            background: var(--white);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .demo-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
            border-color: var(--primary-blue);
        }

        .demo-card i {
            font-size: 3rem;
            color: var(--primary-blue);
            margin-bottom: 1rem;
        }

        .demo-card h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--warm-gray);
        }

        .demo-card p {
            color: var(--light-gray);
            margin-bottom: 1.5rem;
        }

        .start-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30, 58, 138, 0.3);
        }

        /* Onboarding Screens */
        .onboarding-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }

        .progress-bar {
            background: #E0E0E0;
            height: 8px;
            border-radius: 4px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress-fill {
            background: var(--gradient);
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .step-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .step-number {
            background: var(--primary-blue);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-weight: bold;
        }

        .step-title {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: var(--warm-gray);
        }

        .step-subtitle {
            color: var(--light-gray);
            font-size: 1.1rem;
        }

        .form-card {
            background: var(--white);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--warm-gray);
        }

        .form-control {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .option-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .option-card {
            background: #F8F9FA;
            border: 2px solid #E0E0E0;
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-card:hover, .option-card.selected {
            border-color: var(--primary-blue);
            background: var(--light-blue);
            transform: translateY(-2px);
        }

        .option-card i {
            font-size: 2rem;
            color: var(--primary-blue);
            margin-bottom: 0.5rem;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
        }

        .btn {
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .btn-secondary {
            background: #F8F9FA;
            color: var(--warm-gray);
            border: 2px solid #E0E0E0;
        }

        .btn-secondary:hover {
            background: #E9ECEF;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30, 58, 138, 0.3);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Dashboard Preview */
        .dashboard-container {
            padding: 2rem;
        }

        .dashboard-header {
            background: var(--white);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            text-align: center;
        }

        .welcome-message {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: var(--warm-gray);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .dashboard-card {
            background: var(--white);
            padding: 1.5rem;
            border-radius: 15px;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-icon {
            background: var(--gradient);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--warm-gray);
        }

        .metric {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-blue);
            margin-bottom: 0.5rem;
        }

        .metric-label {
            color: var(--light-gray);
            font-size: 0.9rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav {
                padding: 1rem;
            }

            .nav-links {
                gap: 1rem;
            }

            .hero-content h1 {
                font-size: 2.5rem;
            }

            .demo-selector {
                grid-template-columns: 1fr;
            }

            .onboarding-container {
                padding: 1rem;
            }

            .option-grid {
                grid-template-columns: 1fr;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Coach Dashboard Styles */
        .client-list, .session-list, .department-list, .module-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .client-item, .session-item, .department-item, .module-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem;
            background: #F8F9FA;
            border-radius: 10px;
            border: 1px solid #E5E7EB;
            transition: all 0.3s ease;
        }

        .client-item:hover, .session-item:hover, .department-item:hover, .module-item:hover {
            border-color: var(--primary-blue);
            box-shadow: 0 2px 8px rgba(30, 58, 138, 0.1);
        }

        .client-info, .session-details, .department-info, .module-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }

        .client-avatar {
            font-size: 2.5rem;
            color: var(--primary-blue);
        }

        .client-details h4, .session-details h4, .department-info h4, .module-info h4 {
            margin: 0 0 0.25rem 0;
            color: var(--warm-gray);
            font-size: 1.1rem;
        }

        .client-details p, .session-details p, .department-info p, .module-info p {
            margin: 0;
            color: var(--light-gray);
            font-size: 0.9rem;
        }

        .progress-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: var(--light-gray);
        }

        .progress-bar-small {
            background: #E5E7EB;
            height: 6px;
            border-radius: 3px;
            width: 100px;
            overflow: hidden;
        }

        .progress-fill-small {
            background: var(--primary-blue);
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        .client-actions, .session-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-on-track {
            background: #D1FAE5;
            color: #065F46;
        }

        .status-needs-attention {
            background: #FEF3C7;
            color: #92400E;
        }

        .status-excellent {
            background: #DBEAFE;
            color: var(--primary-blue);
        }

        .btn-small {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-small.btn-primary {
            background: var(--primary-blue);
            color: white;
        }

        .btn-small.btn-secondary {
            background: #F3F4F6;
            color: var(--warm-gray);
        }

        .btn-small:hover {
            transform: translateY(-1px);
        }

        .session-time {
            text-align: center;
            min-width: 80px;
        }

        .session-time .time {
            font-weight: bold;
            color: var(--primary-blue);
            font-size: 1.1rem;
        }

        .session-time .date {
            font-size: 0.8rem;
            color: var(--light-gray);
            margin-top: 0.25rem;
        }

        /* Corporate Dashboard Styles */
        .department-stats {
            display: flex;
            gap: 2rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            display: block;
            font-size: 0.8rem;
            color: var(--light-gray);
            margin-bottom: 0.25rem;
        }

        .stat-value {
            font-weight: bold;
            color: var(--primary-blue);
        }

        .completion-rate {
            background: var(--light-blue);
            color: var(--primary-blue);
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .impact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .impact-item {
            display: flex;
            gap: 1rem;
            padding: 1.5rem;
            background: #F8F9FA;
            border-radius: 10px;
            border: 1px solid #E5E7EB;
        }

        .impact-icon {
            font-size: 2rem;
            color: var(--primary-blue);
            min-width: 60px;
            text-align: center;
        }

        .impact-content h4 {
            margin: 0 0 0.5rem 0;
            color: var(--warm-gray);
        }

        .impact-content p {
            margin: 0 0 1rem 0;
            color: var(--light-gray);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .impact-metric {
            background: var(--primary-blue);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Responsive adjustments for new components */
        @media (max-width: 768px) {
            .client-item, .session-item, .department-item, .module-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .client-actions, .session-actions {
                width: 100%;
                justify-content: space-between;
            }

            .department-stats {
                gap: 1rem;
            }

            .impact-grid {
                grid-template-columns: 1fr;
            }

            .impact-item {
                flex-direction: column;
                text-align: center;
            }
        }

        /* Islamic Design Elements */
        .islamic-pattern {
            position: relative;
            overflow: hidden;
        }

        .islamic-pattern::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="islamic" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="1" fill="%23EFF6FF" opacity="0.3"/></pattern></defs><rect width="100" height="100" fill="url(%23islamic)"/></svg>') repeat;
            opacity: 0.1;
            z-index: -1;
        }
    </style>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="logo">NISBA</div>
            <ul class="nav-links">
                <li><a href="#" onclick="showScreen('welcome')" id="homeLink" style="display: none;">Home</a></li>
                <li><a href="#" onclick="showDashboard()" id="dashboardLink" style="display: none;">Dashboard</a></li>
                <li><a href="#" onclick="logout()" id="logoutLink" style="display: none;">Logout</a></li>
                <li><a href="#" onclick="showScreen('login')" id="loginLink">Login</a></li>
                <li><div class="demo-badge">DEMO VERSION</div></li>
            </ul>
        </nav>
    </header>

    <main class="main">
        <!-- Login Screen -->
        <div id="login" class="screen active">
            <div class="container">
                <div class="login-container">
                    <div class="login-card">
                        <div class="login-header">
                            <div class="logo-large">NISBA</div>
                            <h2>Welcome Back</h2>
                            <p>Sign in to your halal investment platform</p>
                        </div>
                        
                        <div class="login-form">
                            <div class="form-group">
                                <label>Email Address</label>
                                <input type="email" class="form-control" id="loginEmail" placeholder="Enter your email">
                            </div>
                            
                            <div class="form-group">
                                <label>Password</label>
                                <input type="password" class="form-control" id="loginPassword" placeholder="Enter your password">
                            </div>
                            
                            <div class="form-options">
                                <label class="checkbox-label">
                                    <input type="checkbox"> Remember me
                                </label>
                                <a href="#" class="forgot-link">Forgot password?</a>
                            </div>
                            
                            <button class="btn btn-primary login-btn" onclick="handleLogin()" id="loginButton">
                                <span class="btn-text">Sign In</span>
                                <span class="btn-loading" style="display: none;">
                                    <i class="fas fa-spinner fa-spin"></i> Signing in...
                                </span>
                            </button>
                            
                            <div class="divider">
                                <span>or</span>
                            </div>
                            
                            <div class="demo-accounts">
                                <h4>Try Demo Accounts:</h4>
                                <p class="demo-explanation">Experience different user perspectives with these pre-configured accounts. Each demonstrates unique features and capabilities.</p>
                                <div class="demo-account-grid">
                                    <button class="demo-account-btn" onclick="loginAsDemo('individual')">
                                        <i class="fas fa-user"></i>
                                        <span>Individual Investor</span>
                                        <small>ahmad@example.com</small>
                                    </button>
                                    
                                    <button class="demo-account-btn" onclick="loginAsDemo('coach')">
                                        <i class="fas fa-chalkboard-teacher"></i>
                                        <span>Coach Account</span>
                                        <small>amina@nisba.co.uk</small>
                                    </button>
                                    
                                    <button class="demo-account-btn" onclick="loginAsDemo('corporate')">
                                        <i class="fas fa-building"></i>
                                        <span>Corporate HR</span>
                                        <small>hr@techcorp.com</small>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="signup-link">
                                Don't have an account? <a href="#" onclick="showScreen('welcome')">Start your journey</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="login-features">
                        <h3>Why Choose NISBA?</h3>
                        <div class="feature-list">
                            <div class="feature-item">
                                <i class="fas fa-shield-alt"></i>
                                <div>
                                    <h4>Shariah Compliant</h4>
                                    <p>All investments screened according to Islamic principles</p>
                                </div>
                            </div>
                            
                            <div class="feature-item">
                                <i class="fas fa-graduation-cap"></i>
                                <div>
                                    <h4>Expert Education</h4>
                                    <p>Learn from qualified Islamic finance professionals</p>
                                </div>
                            </div>
                            
                            <div class="feature-item">
                                <i class="fas fa-users"></i>
                                <div>
                                    <h4>Personal Coaching</h4>
                                    <p>One-on-one guidance to achieve your financial goals</p>
                                </div>
                            </div>
                            
                            <div class="feature-item">
                                <i class="fas fa-chart-line"></i>
                                <div>
                                    <h4>Track Progress</h4>
                                    <p>Monitor your halal investment journey with detailed analytics</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Investment Simulator Screen -->
        <div id="investment-simulator" class="screen">
            <div class="container">
                <div class="simulator-container">
                    <div class="simulator-header">
                        <button class="btn btn-secondary" onclick="showDashboard()" aria-label="Back to dashboard">
                            <i class="fas fa-arrow-left"></i> Back to Dashboard
                        </button>
                        <h2>Investment Simulator</h2>
                        <div class="simulator-balance">
                            <span class="balance-label">Virtual Balance:</span>
                            <span class="balance-amount"><span id="virtualBalance">50000</span></span>
                        </div>
                    </div>

                    <div class="simulator-grid">
                        <!-- Stock Market Section -->
                        <div class="simulator-card">
                            <h3><i class="fas fa-chart-candlestick"></i> Market Overview</h3>
                            <div class="market-list">
                                <div class="stock-item" onclick="selectStock('AAPL', 'Apple Inc.', 175.50, 2.1)">
                                    <div class="stock-info">
                                        <strong>AAPL</strong>
                                        <span>Apple Inc.</span>
                                        <small class="halal-badge"> Halal Approved</small>
                                    </div>
                                    <div class="stock-price">
                                        <span class="price">$175.50</span>
                                        <span class="change positive">+2.1%</span>
                                    </div>
                                </div>
                                
                                <div class="stock-item" onclick="selectStock('MSFT', 'Microsoft Corp.', 332.89, 1.8)">
                                    <div class="stock-info">
                                        <strong>MSFT</strong>
                                        <span>Microsoft Corp.</span>
                                        <small class="halal-badge"> Halal Approved</small>
                                    </div>
                                    <div class="stock-price">
                                        <span class="price">$332.89</span>
                                        <span class="change positive">+1.8%</span>
                                    </div>
                                </div>
                                
                                <div class="stock-item" onclick="selectStock('GOOGL', 'Alphabet Inc.', 142.75, -0.5)">
                                    <div class="stock-info">
                                        <strong>GOOGL</strong>
                                        <span>Alphabet Inc.</span>
                                        <small class="halal-badge warning"> Review Required</small>
                                    </div>
                                    <div class="stock-price">
                                        <span class="price">$142.75</span>
                                        <span class="change negative">-0.5%</span>
                                    </div>
                                </div>
                                
                                <div class="stock-item" onclick="selectStock('TSLA', 'Tesla Inc.', 248.42, 3.2)">
                                    <div class="stock-info">
                                        <strong>TSLA</strong>
                                        <span>Tesla Inc.</span>
                                        <small class="halal-badge"> Halal Approved</small>
                                    </div>
                                    <div class="stock-price">
                                        <span class="price">$248.42</span>
                                        <span class="change positive">+3.2%</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Trading Panel -->
                        <div class="simulator-card">
                            <h3><i class="fas fa-exchange-alt"></i> Place Order</h3>
                            <div class="trading-form" id="tradingForm" style="display: none;">
                                <div class="selected-stock" id="selectedStock">
                                    <!-- Selected stock info will appear here -->
                                </div>
                                
                                <div class="form-group">
                                    <label>Order Type</label>
                                    <select class="form-control" id="orderType">
                                        <option value="buy">Buy</option>
                                        <option value="sell">Sell</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>Quantity</label>
                                    <input type="number" class="form-control" id="quantity" min="1" value="1">
                                </div>
                                
                                <div class="form-group">
                                    <label>Total Cost</label>
                                    <div class="cost-display" id="totalCost">$0.00</div>
                                </div>
                                
                                <button class="btn btn-primary" onclick="executeTrade()" id="executeBtn">
                                    Execute Trade
                                </button>
                            </div>
                            
                            <div class="no-selection" id="noSelection">
                                <i class="fas fa-mouse-pointer"></i>
                                <p>Select a stock from the market to start trading</p>
                            </div>
                        </div>

                        <!-- Portfolio -->
                        <div class="simulator-card">
                            <h3><i class="fas fa-briefcase"></i> My Portfolio</h3>
                            <div class="portfolio-list" id="portfolioList">
                                <div class="empty-portfolio">
                                    <i class="fas fa-chart-pie"></i>
                                    <p>Your portfolio is empty. Start by buying some halal investments!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Halal Stock Screener -->
        <div id="halal-screener" class="screen">
            <div class="container">
                <div class="screener-container">
                    <div class="screener-header">
                        <button class="btn btn-secondary" onclick="showDashboard()" aria-label="Back to dashboard">
                            <i class="fas fa-arrow-left"></i> Back to Dashboard
                        </button>
                        <h2>Halal Stock Screener</h2>
                        <p>Find Shariah-compliant investments based on strict Islamic finance criteria</p>
                    </div>

                    <div class="screener-filters">
                        <div class="filter-card">
                            <h4>Screening Criteria</h4>
                            <div class="filter-grid">
                                <div class="filter-item">
                                    <label>
                                        <input type="checkbox" checked onchange="applyFilters()"> 
                                        No Interest-Based Revenue
                                    </label>
                                </div>
                                <div class="filter-item">
                                    <label>
                                        <input type="checkbox" checked onchange="applyFilters()"> 
                                        No Gambling/Gaming
                                    </label>
                                </div>
                                <div class="filter-item">
                                    <label>
                                        <input type="checkbox" checked onchange="applyFilters()"> 
                                        No Alcohol/Tobacco
                                    </label>
                                </div>
                                <div class="filter-item">
                                    <label>
                                        <input type="checkbox" checked onchange="applyFilters()"> 
                                        Debt Ratio < 33%
                                    </label>
                                </div>
                                <div class="filter-item">
                                    <label>
                                        <input type="checkbox" onchange="applyFilters()"> 
                                        Strict Mode (Extra Screening)
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="filter-card">
                            <h4>Investment Preferences</h4>
                            <div class="filter-grid">
                                <div class="filter-item">
                                    <label>Market Cap</label>
                                    <select class="form-control" onchange="applyFilters()">
                                        <option value="">All</option>
                                        <option value="large">Large Cap (>$10B)</option>
                                        <option value="mid">Mid Cap ($2B-$10B)</option>
                                        <option value="small">Small Cap (<$2B)</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label>Sector</label>
                                    <select class="form-control" onchange="applyFilters()">
                                        <option value="">All Sectors</option>
                                        <option value="tech">Technology</option>
                                        <option value="healthcare">Healthcare</option>
                                        <option value="consumer">Consumer Goods</option>
                                        <option value="industrial">Industrial</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="screener-results">
                        <div class="results-header">
                            <h3>Screening Results</h3>
                            <span class="results-count" id="resultsCount">2,847 stocks found</span>
                        </div>
                        
                        <div class="stocks-table">
                            <div class="table-header">
                                <div class="col-symbol">Symbol</div>
                                <div class="col-name">Company</div>
                                <div class="col-price">Price</div>
                                <div class="col-change">Change</div>
                                <div class="col-halal">Halal Status</div>
                                <div class="col-action">Action</div>
                            </div>
                            
                            <div class="table-row">
                                <div class="col-symbol"><strong>AAPL</strong></div>
                                <div class="col-name">Apple Inc.</div>
                                <div class="col-price">$175.50</div>
                                <div class="col-change positive">+2.1%</div>
                                <div class="col-halal"><span class="halal-approved"> Approved</span></div>
                                <div class="col-action"><button class="btn-small btn-primary">Analyze</button></div>
                            </div>
                            
                            <div class="table-row">
                                <div class="col-symbol"><strong>MSFT</strong></div>
                                <div class="col-name">Microsoft Corporation</div>
                                <div class="col-price">$332.89</div>
                                <div class="col-change positive">+1.8%</div>
                                <div class="col-halal"><span class="halal-approved"> Approved</span></div>
                                <div class="col-action"><button class="btn-small btn-primary">Analyze</button></div>
                            </div>
                            
                            <div class="table-row">
                                <div class="col-symbol"><strong>TSLA</strong></div>
                                <div class="col-name">Tesla Inc.</div>
                                <div class="col-price">$248.42</div>
                                <div class="col-change positive">+3.2%</div>
                                <div class="col-halal"><span class="halal-approved"> Approved</span></div>
                                <div class="col-action"><button class="btn-small btn-primary">Analyze</button></div>
                            </div>
                            
                            <div class="table-row">
                                <div class="col-symbol"><strong>JNJ</strong></div>
                                <div class="col-name">Johnson & Johnson</div>
                                <div class="col-price">$162.34</div>
                                <div class="col-change negative">-0.3%</div>
                                <div class="col-halal"><span class="halal-approved"> Approved</span></div>
                                <div class="col-action"><button class="btn-small btn-primary">Analyze</button></div>
                            </div>
                            
                            <div class="table-row">
                                <div class="col-symbol"><strong>V</strong></div>
                                <div class="col-name">Visa Inc.</div>
                                <div class="col-price">$234.67</div>
                                <div class="col-change positive">+1.1%</div>
                                <div class="col-halal"><span class="halal-approved"> Approved</span></div>
                                <div class="col-action"><button class="btn-small btn-primary">Analyze</button></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Live Coaching Session -->
        <div id="live-session" class="screen">
            <div class="container">
                <div class="session-container">
                    <div class="session-header">
                        <button class="btn btn-secondary" onclick="showScreen('coach-dashboard')" aria-label="Back to coach dashboard">
                            <i class="fas fa-arrow-left"></i> Back to Coach Dashboard
                        </button>
                        <h2>Live Coaching Session</h2>
                        <div class="session-info">
                            <span class="client-name" id="sessionClientName">Ahmad Al-Rashid</span>
                            <span class="session-status live"> LIVE</span>
                        </div>
                    </div>

                    <div class="video-session">
                        <div class="video-area">
                            <div class="main-video">
                                <div class="video-placeholder client-video">
                                    <i class="fas fa-user-circle"></i>
                                    <h3 id="clientVideoName">Ahmad Al-Rashid</h3>
                                    <p>Client Video Feed</p>
                                </div>
                                <div class="video-controls">
                                    <button class="control-btn" onclick="toggleMute()" id="muteBtn">
                                        <i class="fas fa-microphone"></i>
                                    </button>
                                    <button class="control-btn" onclick="toggleVideo()" id="videoBtn">
                                        <i class="fas fa-video"></i>
                                    </button>
                                    <button class="control-btn screen-share" onclick="toggleScreenShare()" id="shareBtn">
                                        <i class="fas fa-desktop"></i> Share Screen
                                    </button>
                                    <button class="control-btn end-call" onclick="endSession()">
                                        <i class="fas fa-phone-slash"></i> End Call
                                    </button>
                                </div>
                            </div>
                            
                            <div class="coach-video">
                                <div class="video-placeholder">
                                    <i class="fas fa-user-circle"></i>
                                    <h4>Amina Hassan (You)</h4>
                                    <p>Coach Video</p>
                                </div>
                            </div>
                        </div>

                        <div class="session-tools">
                            <div class="tool-tabs">
                                <button class="tool-tab active" onclick="showTool('portfolio')" id="portfolioTab">
                                    <i class="fas fa-chart-pie"></i> Portfolio Review
                                </button>
                                <button class="tool-tab" onclick="showTool('goals')" id="goalsTab">
                                    <i class="fas fa-target"></i> Goals
                                </button>
                                <button class="tool-tab" onclick="showTool('education')" id="educationTab">
                                    <i class="fas fa-graduation-cap"></i> Education
                                </button>
                                <button class="tool-tab" onclick="showTool('notes')" id="notesTab">
                                    <i class="fas fa-sticky-note"></i> Notes
                                </button>
                            </div>

                            <div class="tool-content">
                                <div class="tool-panel active" id="portfolioPanel">
                                    <h4>Client Portfolio Analysis</h4>
                                    <div class="portfolio-metrics">
                                        <div class="metric-item">
                                            <span class="metric-label">Total Value:</span>
                                            <span class="metric-value">12,847</span>
                                        </div>
                                        <div class="metric-item">
                                            <span class="metric-label">Monthly Growth:</span>
                                            <span class="metric-value positive">+7.2%</span>
                                        </div>
                                        <div class="metric-item">
                                            <span class="metric-label">Risk Level:</span>
                                            <span class="metric-value">Moderate</span>
                                        </div>
                                    </div>
                                    <div class="recommendations">
                                        <h5>Recommendations:</h5>
                                        <ul>
                                            <li>Consider increasing monthly contribution by 200</li>
                                            <li>Rebalance towards more growth-oriented halal ETFs</li>
                                            <li>Review Zakat obligations for next year</li>
                                        </ul>
                                    </div>
                                </div>

                                <div class="tool-panel" id="goalsPanel">
                                    <h4>Goal Progress Tracking</h4>
                                    <div class="goal-item">
                                        <div class="goal-header">
                                            <h5>House Deposit Goal</h5>
                                            <span class="goal-progress">68%</span>
                                        </div>
                                        <div class="progress-bar-small">
                                            <div class="progress-fill-small" style="width: 68%"></div>
                                        </div>
                                        <p>Target: 45,000 by Dec 2025</p>
                                    </div>
                                </div>

                                <div class="tool-panel" id="educationPanel">
                                    <h4>Educational Resources</h4>
                                    <div class="resource-list">
                                        <div class="resource-item">
                                            <i class="fas fa-play-circle"></i>
                                            <span>Halal Investment Basics</span>
                                            <button class="btn-small btn-primary">Share</button>
                                        </div>
                                        <div class="resource-item">
                                            <i class="fas fa-file-pdf"></i>
                                            <span>Zakat Calculation Guide</span>
                                            <button class="btn-small btn-primary">Share</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="tool-panel" id="notesPanel">
                                    <h4>Session Notes</h4>
                                    <textarea class="session-notes" placeholder="Add notes about this session...">
Client seems confident about current strategy. Discussed:
- Increasing monthly savings from 500 to 700
- Adding international halal ETF exposure
- Planning for Zakat payment in Q2
                                    </textarea>
                                    <button class="btn btn-primary">Save Notes</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Welcome Screen -->
        <div id="welcome" class="screen islamic-pattern">
            <div class="container">
                <div class="welcome-screen">
                    <div class="hero-content">
                        <h1>Your Halal Investment Journey Starts Here</h1>
                        <p>Experience the future of Islamic finance education and coaching. Navigate through our comprehensive platform designed to transform knowledge into action.</p>
                    </div>
                    
                    <div class="demo-selector">
                        <div class="demo-card" onclick="startDemo('individual')">
                            <i class="fas fa-user"></i>
                            <h3>Individual Investor</h3>
                            <p>Experience the complete journey from onboarding to investment planning and coaching.</p>
                            <button class="start-btn">Start Individual Demo</button>
                        </div>
                        
                        <div class="demo-card" onclick="startDemo('coach')">
                            <i class="fas fa-chalkboard-teacher"></i>
                            <h3>Coach Dashboard</h3>
                            <p>See how coaches manage clients, track progress, and deliver personalized guidance.</p>
                            <button class="start-btn">View Coach Demo</button>
                        </div>
                        
                        <div class="demo-card" onclick="startDemo('corporate')">
                            <i class="fas fa-building"></i>
                            <h3>Corporate Portal</h3>
                            <p>Explore enterprise features for HR teams and employee financial wellness programs.</p>
                            <button class="start-btn">See Corporate Demo</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Individual Demo Screens -->
        <div id="step1" class="screen">
            <div class="container">
                <div class="onboarding-container">
                    <!-- Breadcrumb Navigation -->
                    <nav class="breadcrumb" aria-label="Onboarding progress">
                        <ol class="breadcrumb-list">
                            <li class="breadcrumb-item active" aria-current="step">
                                <span class="breadcrumb-number">1</span>
                                <span class="breadcrumb-label">Personal Info</span>
                            </li>
                            <li class="breadcrumb-item">
                                <span class="breadcrumb-number">2</span>
                                <span class="breadcrumb-label">Goals</span>
                            </li>
                            <li class="breadcrumb-item">
                                <span class="breadcrumb-number">3</span>
                                <span class="breadcrumb-label">Preferences</span>
                            </li>
                            <li class="breadcrumb-item">
                                <span class="breadcrumb-number">4</span>
                                <span class="breadcrumb-label">Coaching</span>
                            </li>
                        </ol>
                    </nav>

                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 20%"></div>
                    </div>
                    
                    <div class="step-header">
                        <div class="step-number">1</div>
                        <h2 class="step-title">Welcome to NISBA</h2>
                        <p class="step-subtitle">Let's get to know you and your Islamic finance goals</p>
                    </div>
                    
                    <div class="form-card">
                        <div class="form-group">
                            <label for="userName">What's your name?</label>
                            <input type="text" class="form-control" id="userName" placeholder="Enter your full name" aria-describedby="userName-help">
                            <small id="userName-help" class="form-help">This helps us personalize your experience</small>
                        </div>
                        
                        <div class="form-group">
                            <label>What's your current knowledge level with halal investing?</label>
                            <div class="option-grid" role="radiogroup" aria-label="Knowledge level selection">
                                <div class="option-card" onclick="selectOption(this, 'beginner')" role="radio" aria-checked="false" tabindex="0" onkeydown="handleKeySelection(event, this, 'beginner')">
                                    <i class="fas fa-seedling" aria-hidden="true"></i>
                                    <h4>Complete Beginner</h4>
                                    <p>New to Islamic finance</p>
                                </div>
                                <div class="option-card" onclick="selectOption(this, 'intermediate')" role="radio" aria-checked="false" tabindex="0" onkeydown="handleKeySelection(event, this, 'intermediate')">
                                    <i class="fas fa-chart-line" aria-hidden="true"></i>
                                    <h4>Some Knowledge</h4>
                                    <p>Understand basics</p>
                                </div>
                                <div class="option-card" onclick="selectOption(this, 'advanced')" role="radio" aria-checked="false" tabindex="0" onkeydown="handleKeySelection(event, this, 'advanced')">
                                    <i class="fas fa-graduation-cap" aria-hidden="true"></i>
                                    <h4>Experienced</h4>
                                    <p>Already investing</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn btn-secondary" onclick="showScreen('welcome')" aria-label="Go back to welcome screen">
                            <i class="fas fa-arrow-left" aria-hidden="true"></i> Back
                        </button>
                        <button class="btn btn-primary" id="step1Next" onclick="nextStep(2)" disabled aria-label="Continue to step 2">
                            Next <i class="fas fa-arrow-right" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="step2" class="screen">
            <div class="container">
                <div class="onboarding-container">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 40%"></div>
                    </div>
                    
                    <div class="step-header">
                        <div class="step-number">2</div>
                        <h2 class="step-title">Your Financial Goals</h2>
                        <p class="step-subtitle">What would you like to achieve with halal investing?</p>
                    </div>
                    
                    <div class="form-card">
                        <div class="form-group">
                            <label>Select your primary investment goals (choose all that apply):</label>
                            <div class="option-grid">
                                <div class="option-card" onclick="toggleSelection(this, 'retirement')">
                                    <i class="fas fa-piggy-bank"></i>
                                    <h4>Retirement Planning</h4>
                                    <p>Long-term wealth building</p>
                                </div>
                                <div class="option-card" onclick="toggleSelection(this, 'house')">
                                    <i class="fas fa-home"></i>
                                    <h4>House Deposit</h4>
                                    <p>Save for property purchase</p>
                                </div>
                                <div class="option-card" onclick="toggleSelection(this, 'education')">
                                    <i class="fas fa-graduation-cap"></i>
                                    <h4>Children's Education</h4>
                                    <p>Educational fund planning</p>
                                </div>
                                <div class="option-card" onclick="toggleSelection(this, 'emergency')">
                                    <i class="fas fa-shield-alt"></i>
                                    <h4>Emergency Fund</h4>
                                    <p>Financial security</p>
                                </div>
                                <div class="option-card" onclick="toggleSelection(this, 'zakat')">
                                    <i class="fas fa-hands-helping"></i>
                                    <h4>Zakat Optimization</h4>
                                    <p>Charitable giving planning</p>
                                </div>
                                <div class="option-card" onclick="toggleSelection(this, 'business')">
                                    <i class="fas fa-briefcase"></i>
                                    <h4>Start a Business</h4>
                                    <p>Entrepreneurial funding</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn btn-secondary" onclick="prevStep(1)">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="btn btn-primary" id="step2Next" onclick="nextStep(3)" disabled>
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="step3" class="screen">
            <div class="container">
                <div class="onboarding-container">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 60%"></div>
                    </div>
                    
                    <div class="step-header">
                        <div class="step-number">3</div>
                        <h2 class="step-title">Investment Preferences</h2>
                        <p class="step-subtitle">Help us understand your halal investment criteria</p>
                    </div>
                    
                    <div class="form-card">
                        <div class="form-group">
                            <label>How much can you invest monthly?</label>
                            <select class="form-control" id="monthlyAmount">
                                <option value="">Select amount</option>
                                <option value="100-500">100 - 500</option>
                                <option value="500-1000">500 - 1,000</option>
                                <option value="1000-2500">1,000 - 2,500</option>
                                <option value="2500+">2,500+</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Risk tolerance level:</label>
                            <div class="option-grid">
                                <div class="option-card" onclick="selectOption(this, 'conservative')">
                                    <i class="fas fa-shield-alt"></i>
                                    <h4>Conservative</h4>
                                    <p>Low risk, steady returns</p>
                                </div>
                                <div class="option-card" onclick="selectOption(this, 'moderate')">
                                    <i class="fas fa-balance-scale"></i>
                                    <h4>Moderate</h4>
                                    <p>Balanced approach</p>
                                </div>
                                <div class="option-card" onclick="selectOption(this, 'aggressive')">
                                    <i class="fas fa-rocket"></i>
                                    <h4>Aggressive</h4>
                                    <p>Higher risk for growth</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Shariah compliance preference:</label>
                            <div class="option-grid">
                                <div class="option-card" onclick="selectOption(this, 'strict')">
                                    <i class="fas fa-mosque"></i>
                                    <h4>Strict Screening</h4>
                                    <p>Maximum compliance</p>
                                </div>
                                <div class="option-card" onclick="selectOption(this, 'standard')">
                                    <i class="fas fa-check-circle"></i>
                                    <h4>Standard Screening</h4>
                                    <p>Industry standard</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn btn-secondary" onclick="prevStep(2)">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="btn btn-primary" id="step3Next" onclick="nextStep(4)" disabled>
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="step4" class="screen">
            <div class="container">
                <div class="onboarding-container">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 80%"></div>
                    </div>
                    
                    <div class="step-header">
                        <div class="step-number">4</div>
                        <h2 class="step-title">Coaching Preferences</h2>
                        <p class="step-subtitle">How would you like to receive support and guidance?</p>
                    </div>
                    
                    <div class="form-card">
                        <div class="form-group">
                            <label>Preferred coaching frequency:</label>
                            <div class="option-grid">
                                <div class="option-card" onclick="selectOption(this, 'weekly')">
                                    <i class="fas fa-calendar-week"></i>
                                    <h4>Weekly Check-ins</h4>
                                    <p>Intensive support</p>
                                </div>
                                <div class="option-card" onclick="selectOption(this, 'biweekly')">
                                    <i class="fas fa-calendar-alt"></i>
                                    <h4>Bi-weekly Sessions</h4>
                                    <p>Regular guidance</p>
                                </div>
                                <div class="option-card" onclick="selectOption(this, 'monthly')">
                                    <i class="fas fa-calendar"></i>
                                    <h4>Monthly Reviews</h4>
                                    <p>Periodic oversight</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Communication preferences:</label>
                            <div class="option-grid">
                                <div class="option-card" onclick="toggleSelection(this, 'video')">
                                    <i class="fas fa-video"></i>
                                    <h4>Video Calls</h4>
                                    <p>Face-to-face sessions</p>
                                </div>
                                <div class="option-card" onclick="toggleSelection(this, 'phone')">
                                    <i class="fas fa-phone"></i>
                                    <h4>Phone Calls</h4>
                                    <p>Voice conversations</p>
                                </div>
                                <div class="option-card" onclick="toggleSelection(this, 'chat')">
                                    <i class="fas fa-comments"></i>
                                    <h4>Text Messaging</h4>
                                    <p>Written communication</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="btn btn-secondary" onclick="prevStep(3)">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="btn btn-primary" id="step4Next" onclick="completeOnboarding()">
                            Complete Setup <i class="fas fa-check"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Individual Dashboard Screen -->
        <div id="dashboard" class="screen">
            <div class="container">
                <div class="dashboard-container">
                    <div class="dashboard-header islamic-pattern">
                        <h2 class="welcome-message">Assalamu Alaikum, <span id="dashboardName">Ahmad</span>!</h2>
                        <p>Here's your halal investment journey progress</p>
                    </div>
                    
                    <div class="dashboard-grid">
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-piggy-bank"></i>
                                </div>
                                <div class="card-title">
                                    Investment Portfolio
                                    <button class="help-btn" onclick="showTooltip(this, 'Your total halal investment value across all accounts and platforms')" aria-label="More information about investment portfolio">
                                        <i class="fas fa-question-circle" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="metric">12,847</div>
                            <div class="metric-label">Total halal investments</div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="card-title">
                                    Monthly Growth
                                    <button class="help-btn" onclick="showTooltip(this, 'Percentage increase in your portfolio value this month compared to last month')" aria-label="More information about monthly growth">
                                        <i class="fas fa-question-circle" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="metric">+7.2%</div>
                            <div class="metric-label">This month's return</div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-target"></i>
                                </div>
                                <div class="card-title">
                                    Goal Progress
                                    <button class="help-btn" onclick="showTooltip(this, 'How close you are to reaching your primary financial goal based on current savings rate')" aria-label="More information about goal progress">
                                        <i class="fas fa-question-circle" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="metric">68%</div>
                            <div class="metric-label">House deposit goal</div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-hands-helping"></i>
                                </div>
                                <div class="card-title">
                                    Zakat Due
                                    <button class="help-btn" onclick="showTooltip(this, 'Estimated Zakat obligation based on your current wealth and investments (2.5% annually)')" aria-label="More information about Zakat calculation">
                                        <i class="fas fa-question-circle" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="metric">321</div>
                            <div class="metric-label">Estimated annual Zakat</div>
                        </div>
                        
                        <div class="dashboard-card clickable-card" onclick="showInvestmentSimulator()">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="card-title">
                                    Investment Simulator
                                    <button class="help-btn" onclick="event.stopPropagation(); showTooltip(this, 'Practice halal investing with virtual money - no risk, real learning')" aria-label="More information about investment simulator">
                                        <i class="fas fa-question-circle" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="metric">50,000</div>
                            <div class="metric-label">Virtual portfolio balance</div>
                            <div class="card-action">
                                <i class="fas fa-play-circle"></i> Start Trading Session
                            </div>
                        </div>

                        <div class="dashboard-card clickable-card" onclick="showHalalScreener()">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-filter"></i>
                                </div>
                                <div class="card-title">
                                    Halal Stock Screener
                                    <button class="help-btn" onclick="event.stopPropagation(); showTooltip(this, 'Find Shariah-compliant investments with our advanced screening tool')" aria-label="More information about halal screener">
                                        <i class="fas fa-question-circle" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="metric">2,847</div>
                            <div class="metric-label">Halal stocks available</div>
                            <div class="card-action">
                                <i class="fas fa-search"></i> Browse Investments
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 2rem;">
                        <button class="btn btn-primary" onclick="showScreen('welcome')">
                            <i class="fas fa-home"></i> Back to Demo Selection
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Coach Dashboard Screen -->
        <div id="coach-dashboard" class="screen">
            <div class="container">
                <div class="dashboard-container">
                    <div class="dashboard-header islamic-pattern">
                        <h2 class="welcome-message">Coach Dashboard - Amina Hassan</h2>
                        <p>Manage your clients and track their halal investment progress</p>
                    </div>

                    <!-- Coach Stats Overview -->
                    <div class="dashboard-grid">
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="card-title">Active Clients</div>
                            </div>
                            <div class="metric">24</div>
                            <div class="metric-label">Currently coaching</div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="card-title">Sessions This Week</div>
                            </div>
                            <div class="metric">12</div>
                            <div class="metric-label">Scheduled sessions</div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="card-title">Client Success Rate</div>
                            </div>
                            <div class="metric">94%</div>
                            <div class="metric-label">Goals achieved</div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="card-title">Average Rating</div>
                            </div>
                            <div class="metric">4.8</div>
                            <div class="metric-label">Client satisfaction</div>
                        </div>
                    </div>

                    <!-- Client Management Section -->
                    <div class="form-card" style="margin-top: 2rem;">
                        <div class="card-header-with-search">
                            <h3 style="margin-bottom: 0; color: var(--warm-gray);">
                                <i class="fas fa-users" style="margin-right: 0.5rem; color: var(--primary-blue);"></i>
                                Client Portfolio Management
                            </h3>
                            <div class="search-container">
                                <div class="search-box">
                                    <i class="fas fa-search" aria-hidden="true"></i>
                                    <input type="text" placeholder="Search clients..." id="clientSearch" onkeyup="filterClients(this.value)" aria-label="Search clients">
                                </div>
                                <div class="filter-dropdown">
                                    <select onchange="filterClientsByStatus(this.value)" aria-label="Filter by status">
                                        <option value="">All Status</option>
                                        <option value="on-track">On Track</option>
                                        <option value="needs-attention">Needs Attention</option>
                                        <option value="excellent">Excellent</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="client-list" id="clientList">
                            <div class="client-item">
                                <div class="client-info">
                                    <div class="client-avatar">
                                        <i class="fas fa-user-circle"></i>
                                    </div>
                                    <div class="client-details">
                                        <h4>Ahmad Al-Rashid</h4>
                                        <p>Goal: House Deposit  45,000 target</p>
                                        <span class="progress-indicator">
                                            <div class="progress-bar-small">
                                                <div class="progress-fill-small" style="width: 68%"></div>
                                            </div>
                                            68% Complete
                                        </span>
                                    </div>
                                </div>
                                <div class="client-actions">
                                    <span class="status-badge status-on-track">On Track</span>
                                    <button class="btn-small btn-primary">Schedule Call</button>
                                </div>
                            </div>

                            <div class="client-item">
                                <div class="client-info">
                                    <div class="client-avatar">
                                        <i class="fas fa-user-circle"></i>
                                    </div>
                                    <div class="client-details">
                                        <h4>Fatima Sheikh</h4>
                                        <p>Goal: Retirement Planning  500k target</p>
                                        <span class="progress-indicator">
                                            <div class="progress-bar-small">
                                                <div class="progress-fill-small" style="width: 32%"></div>
                                            </div>
                                            32% Complete
                                        </span>
                                    </div>
                                </div>
                                <div class="client-actions">
                                    <span class="status-badge status-needs-attention">Needs Attention</span>
                                    <button class="btn-small btn-primary">View Details</button>
                                </div>
                            </div>

                            <div class="client-item">
                                <div class="client-info">
                                    <div class="client-avatar">
                                        <i class="fas fa-user-circle"></i>
                                    </div>
                                    <div class="client-details">
                                        <h4>Omar Hassan</h4>
                                        <p>Goal: Emergency Fund  25,000 target</p>
                                        <span class="progress-indicator">
                                            <div class="progress-bar-small">
                                                <div class="progress-fill-small" style="width: 89%"></div>
                                            </div>
                                            89% Complete
                                        </span>
                                    </div>
                                </div>
                                <div class="client-actions">
                                    <span class="status-badge status-excellent">Excellent</span>
                                    <button class="btn-small btn-primary">Send Message</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Upcoming Sessions -->
                    <div class="form-card" style="margin-top: 2rem;">
                        <h3 style="margin-bottom: 1.5rem; color: var(--warm-gray);">
                            <i class="fas fa-calendar-alt" style="margin-right: 0.5rem; color: var(--primary-blue);"></i>
                            Upcoming Sessions
                        </h3>
                        
                        <div class="session-list">
                            <div class="session-item">
                                <div class="session-time">
                                    <div class="time">2:00 PM</div>
                                    <div class="date">Today</div>
                                </div>
                                <div class="session-details">
                                    <h4>Ahmad Al-Rashid</h4>
                                    <p>Monthly Review & Goal Adjustment</p>
                                </div>
                                <div class="session-actions">
                                    <button class="btn-small btn-secondary">Reschedule</button>
                                    <button class="btn-small btn-primary" onclick="startLiveSession('Ahmad Al-Rashid')">Join Call</button>
                                </div>
                            </div>

                            <div class="session-item">
                                <div class="session-time">
                                    <div class="time">10:00 AM</div>
                                    <div class="date">Tomorrow</div>
                                </div>
                                <div class="session-details">
                                    <h4>Fatima Sheikh</h4>
                                    <p>Investment Strategy Discussion</p>
                                </div>
                                <div class="session-actions">
                                    <button class="btn-small btn-secondary">Reschedule</button>
                                    <button class="btn-small btn-primary">Prepare</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 2rem;">
                        <button class="btn btn-primary" onclick="showScreen('welcome')">
                            <i class="fas fa-home"></i> Back to Demo Selection
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Corporate Portal Screen -->
        <div id="corporate-dashboard" class="screen">
            <div class="container">
                <div class="dashboard-container">
                    <div class="dashboard-header islamic-pattern">
                        <h2 class="welcome-message">Corporate Portal - TechCorp Ltd</h2>
                        <p>Employee Financial Wellness & Islamic Finance Education</p>
                    </div>

                    <!-- Corporate Overview Stats -->
                    <div class="dashboard-grid">
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-building"></i>
                                </div>
                                <div class="card-title">Total Employees</div>
                            </div>
                            <div class="metric">247</div>
                            <div class="metric-label">Enrolled in program</div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="card-title">Course Completion</div>
                            </div>
                            <div class="metric">78%</div>
                            <div class="metric-label">Average completion rate</div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="card-title">Active Learners</div>
                            </div>
                            <div class="metric">189</div>
                            <div class="metric-label">This month</div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-chart-bar"></i>
                                </div>
                                <div class="card-title">Engagement Score</div>
                            </div>
                            <div class="metric">92%</div>
                            <div class="metric-label">Employee satisfaction</div>
                        </div>
                    </div>

                    <!-- Department Analytics -->
                    <div class="form-card" style="margin-top: 2rem;">
                        <h3 style="margin-bottom: 1.5rem; color: var(--warm-gray);">
                            <i class="fas fa-chart-pie" style="margin-right: 0.5rem; color: var(--primary-blue);"></i>
                            Department Analytics
                        </h3>
                        
                        <div class="department-list">
                            <div class="department-item">
                                <div class="department-info">
                                    <h4>Engineering</h4>
                                    <p>85 employees</p>
                                </div>
                                <div class="department-stats">
                                    <div class="stat-item">
                                        <span class="stat-label">Completion</span>
                                        <span class="stat-value">82%</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-label">Coaching</span>
                                        <span class="stat-value">34 enrolled</span>
                                    </div>
                                </div>
                                <div class="progress-bar-small">
                                    <div class="progress-fill-small" style="width: 82%"></div>
                                </div>
                            </div>

                            <div class="department-item">
                                <div class="department-info">
                                    <h4>Marketing</h4>
                                    <p>42 employees</p>
                                </div>
                                <div class="department-stats">
                                    <div class="stat-item">
                                        <span class="stat-label">Completion</span>
                                        <span class="stat-value">91%</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-label">Coaching</span>
                                        <span class="stat-value">18 enrolled</span>
                                    </div>
                                </div>
                                <div class="progress-bar-small">
                                    <div class="progress-fill-small" style="width: 91%"></div>
                                </div>
                            </div>

                            <div class="department-item">
                                <div class="department-info">
                                    <h4>Finance</h4>
                                    <p>28 employees</p>
                                </div>
                                <div class="department-stats">
                                    <div class="stat-item">
                                        <span class="stat-label">Completion</span>
                                        <span class="stat-value">96%</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-label">Coaching</span>
                                        <span class="stat-value">15 enrolled</span>
                                    </div>
                                </div>
                                <div class="progress-bar-small">
                                    <div class="progress-fill-small" style="width: 96%"></div>
                                </div>
                            </div>

                            <div class="department-item">
                                <div class="department-info">
                                    <h4>HR & Operations</h4>
                                    <p>92 employees</p>
                                </div>
                                <div class="department-stats">
                                    <div class="stat-item">
                                        <span class="stat-label">Completion</span>
                                        <span class="stat-value">74%</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-label">Coaching</span>
                                        <span class="stat-value">28 enrolled</span>
                                    </div>
                                </div>
                                <div class="progress-bar-small">
                                    <div class="progress-fill-small" style="width: 74%"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Learning Modules Management -->
                    <div class="form-card" style="margin-top: 2rem;">
                        <h3 style="margin-bottom: 1.5rem; color: var(--warm-gray);">
                            <i class="fas fa-book-open" style="margin-right: 0.5rem; color: var(--primary-blue);"></i>
                            Learning Modules & Assignments
                        </h3>
                        
                        <div class="module-list">
                            <div class="module-item">
                                <div class="module-info">
                                    <h4>Introduction to Halal Investing</h4>
                                    <p>Foundation course  4 weeks  247 enrolled</p>
                                </div>
                                <div class="module-stats">
                                    <span class="completion-rate">89% completion</span>
                                    <button class="btn-small btn-primary">View Reports</button>
                                </div>
                            </div>

                            <div class="module-item">
                                <div class="module-info">
                                    <h4>Zakat Calculation & Planning</h4>
                                    <p>Specialized course  2 weeks  156 enrolled</p>
                                </div>
                                <div class="module-stats">
                                    <span class="completion-rate">76% completion</span>
                                    <button class="btn-small btn-primary">Assign to Teams</button>
                                </div>
                            </div>

                            <div class="module-item">
                                <div class="module-info">
                                    <h4>Retirement Planning (Islamic)</h4>
                                    <p>Advanced course  6 weeks  98 enrolled</p>
                                </div>
                                <div class="module-stats">
                                    <span class="completion-rate">68% completion</span>
                                    <button class="btn-small btn-primary">Monitor Progress</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- DEI & Benefits Impact -->
                    <div class="form-card" style="margin-top: 2rem;">
                        <h3 style="margin-bottom: 1.5rem; color: var(--warm-gray);">
                            <i class="fas fa-heart" style="margin-right: 0.5rem; color: var(--primary-blue);"></i>
                            DEI & Employee Benefits Impact
                        </h3>
                        
                        <div class="impact-grid">
                            <div class="impact-item">
                                <div class="impact-icon">
                                    <i class="fas fa-diversity"></i>
                                </div>
                                <div class="impact-content">
                                    <h4>Inclusive Benefits</h4>
                                    <p>Providing faith-aligned financial education demonstrates commitment to diverse employee needs</p>
                                    <span class="impact-metric">94% of Muslim employees report feeling more valued</span>
                                </div>
                            </div>

                            <div class="impact-item">
                                <div class="impact-icon">
                                    <i class="fas fa-users-cog"></i>
                                </div>
                                <div class="impact-content">
                                    <h4>Retention & Satisfaction</h4>
                                    <p>Faith-aligned benefits increase employee loyalty and job satisfaction across all demographics</p>
                                    <span class="impact-metric">18% increase in retention rate</span>
                                </div>
                            </div>

                            <div class="impact-item">
                                <div class="impact-icon">
                                    <i class="fas fa-award"></i>
                                </div>
                                <div class="impact-content">
                                    <h4>Employer Brand</h4>
                                    <p>Progressive benefits package enhances company reputation as an inclusive, forward-thinking employer</p>
                                    <span class="impact-metric">Top 10% employer rating in diversity</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 2rem;">
                        <button class="btn btn-primary" onclick="showScreen('welcome')">
                            <i class="fas fa-home"></i> Back to Demo Selection
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Global state
        let currentStep = 1;
        let currentUser = null;
        let userProfile = {
            name: '',
            knowledgeLevel: '',
            goals: [],
            monthlyAmount: '',
            riskTolerance: '',
            complianceLevel: '',
            coachingFrequency: '',
            communicationPrefs: []
        };
        let isOnline = navigator.onLine;

        // Demo user accounts
        const demoUsers = {
            individual: {
                type: 'individual',
                name: 'Ahmad Al-Rashid',
                email: 'ahmad@example.com',
                dashboard: 'dashboard'
            },
            coach: {
                type: 'coach',
                name: 'Amina Hassan',
                email: 'amina@nisba.co.uk',
                dashboard: 'coach-dashboard'
            },
            corporate: {
                type: 'corporate',
                name: 'Sarah Wilson',
                email: 'hr@techcorp.com',
                dashboard: 'corporate-dashboard'
            }
        };

        // Data persistence functions
        function saveProgress() {
            const progressData = {
                currentStep,
                userProfile,
                timestamp: new Date().toISOString()
            };
            try {
                // Store in memory for demo (would be localStorage in real app)
                window.nisbaProgress = progressData;
                showNotification('Progress saved automatically', 'success');
            } catch (error) {
                console.warn('Could not save progress:', error);
            }
        }

        function loadProgress() {
            try {
                // Load from memory (would be localStorage in real app)
                const saved = window.nisbaProgress;
                if (saved && saved.userProfile) {
                    userProfile = saved.userProfile;
                    currentStep = saved.currentStep;
                    
                    // Restore form values
                    if (userProfile.name) {
                        const nameInput = document.getElementById('userName');
                        if (nameInput) nameInput.value = userProfile.name;
                    }
                    
                    showNotification('Previous progress restored', 'info');
                    return true;
                }
            } catch (error) {
                console.warn('Could not load progress:', error);
            }
            return false;
        }

        // Online/offline handling
        function handleConnectionChange() {
            isOnline = navigator.onLine;
            if (!isOnline) {
                showNotification('You are currently offline. Progress will be saved locally.', 'warning');
                document.body.classList.add('offline-mode');
            } else {
                showNotification('Connection restored', 'success');
                document.body.classList.remove('offline-mode');
            }
        }

        // Enhanced error handling
        function handleError(error, context = 'Application') {
            console.error(`${context} Error:`, error);
            
            if (!isOnline) {
                showNotification('Action failed: You are currently offline', 'error');
            } else {
                showNotification(`${context} error occurred. Please try again.`, 'error');
            }
        }

        // Authentication functions
        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const loginButton = document.getElementById('loginButton');
            
            if (!email || !password) {
                showNotification('Please enter both email and password', 'error');
                return;
            }
            
            if (!isOnline) {
                showNotification('Cannot login while offline', 'error');
                return;
            }
            
            // Show loading state
            showLoading(loginButton, true);
            
            // Simulate API call delay with error handling
            setTimeout(() => {
                try {
                    if (password === 'demo123') {
                        // Find user by email
                        const userType = Object.keys(demoUsers).find(type => 
                            demoUsers[type].email === email
                        );
                        
                        if (userType) {
                            showLoading(loginButton, false);
                            loginAsDemo(userType);
                            showNotification(`Welcome back, ${demoUsers[userType].name}!`, 'success');
                        } else {
                            showLoading(loginButton, false);
                            showNotification('Email not found. Try one of the demo accounts below.', 'error');
                        }
                    } else {
                        showLoading(loginButton, false);
                        showNotification('Invalid password. Use "demo123" for any demo account.', 'error');
                    }
                } catch (error) {
                    showLoading(loginButton, false);
                    handleError(error, 'Login');
                }
            }, 1500);
        }

        function showLoading(button, isLoading) {
            const btnText = button.querySelector('.btn-text');
            const btnLoading = button.querySelector('.btn-loading');
            
            if (isLoading) {
                btnText.style.display = 'none';
                btnLoading.style.display = 'inline';
                button.disabled = true;
            } else {
                btnText.style.display = 'inline';
                btnLoading.style.display = 'none';
                button.disabled = false;
            }
        }

        function showNotification(message, type = 'info') {
            // Remove existing notifications
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();
            
            // Create notification
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.setAttribute('role', 'alert');
            notification.setAttribute('aria-live', 'polite');
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle'}" aria-hidden="true"></i>
                    <span>${message}</span>
                    <button class="notification-close" onclick="this.parentElement.parentElement.remove()" aria-label="Close notification">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }

        function loginAsDemo(userType) {
            currentUser = demoUsers[userType];
            updateNavigation(true);
            showScreen(currentUser.dashboard);
            
            // Update dashboard name if individual user
            if (userType === 'individual') {
                document.getElementById('dashboardName').textContent = currentUser.name;
            }
        }

        function logout() {
            currentUser = null;
            updateNavigation(false);
            showScreen('login');
            
            // Clear form data
            document.getElementById('loginEmail').value = '';
            document.getElementById('loginPassword').value = '';
        }

        function updateNavigation(isLoggedIn) {
            document.getElementById('homeLink').style.display = isLoggedIn ? 'block' : 'none';
            document.getElementById('dashboardLink').style.display = isLoggedIn ? 'block' : 'none';
            document.getElementById('logoutLink').style.display = isLoggedIn ? 'block' : 'none';
            document.getElementById('loginLink').style.display = isLoggedIn ? 'none' : 'block';
        }

        function showDashboard() {
            if (currentUser) {
                showScreen(currentUser.dashboard);
            } else {
                showScreen('login');
            }
        }

        // Navigation functions
        function showScreen(screenId) {
            // Check if user needs to be logged in for certain screens
            const protectedScreens = ['dashboard', 'coach-dashboard', 'corporate-dashboard'];
            
            if (protectedScreens.includes(screenId) && !currentUser) {
                showScreen('login');
                return;
            }
            
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function nextStep(step) {
            saveProgress(); // Auto-save progress
            showScreen(`step${step}`);
            currentStep = step;
            updateProgress();
            updateBreadcrumbs();
        }

        function prevStep(step) {
            showScreen(`step${step}`);
            currentStep = step;
            updateProgress();
            updateBreadcrumbs();
        }

        function updateBreadcrumbs() {
            document.querySelectorAll('.breadcrumb-item').forEach((item, index) => {
                item.classList.remove('active', 'completed');
                if (index + 1 === currentStep) {
                    item.classList.add('active');
                } else if (index + 1 < currentStep) {
                    item.classList.add('completed');
                }
            });
        }

        // Search and filter functions
        function filterClients(searchTerm) {
            const clients = document.querySelectorAll('.client-item');
            clients.forEach(client => {
                const name = client.querySelector('h4').textContent.toLowerCase();
                const goal = client.querySelector('p').textContent.toLowerCase();
                if (name.includes(searchTerm.toLowerCase()) || goal.includes(searchTerm.toLowerCase())) {
                    client.style.display = 'flex';
                } else {
                    client.style.display = 'none';
                }
            });
        }

        function filterClientsByStatus(status) {
            const clients = document.querySelectorAll('.client-item');
            clients.forEach(client => {
                const statusElement = client.querySelector('.status-badge');
                if (!status || statusElement.className.includes(status)) {
                    client.style.display = 'flex';
                } else {
                    client.style.display = 'none';
                }
            });
        }

        // Tooltip system
        function showTooltip(button, message) {
            // Remove existing tooltips
            document.querySelectorAll('.tooltip').forEach(tooltip => tooltip.remove());
            
            const tooltip = document.createElement('div');
            tooltip.className = 'tooltip';
            tooltip.textContent = message;
            tooltip.setAttribute('role', 'tooltip');
            
            document.body.appendChild(tooltip);
            
            const buttonRect = button.getBoundingClientRect();
            tooltip.style.position = 'fixed';
            tooltip.style.top = (buttonRect.bottom + 10) + 'px';
            tooltip.style.left = (buttonRect.left + buttonRect.width / 2) + 'px';
            tooltip.style.transform = 'translateX(-50%)';
            
            // Auto-remove after 3 seconds
            setTimeout(() => {
                if (tooltip.parentNode) {
                    tooltip.remove();
                }
            }, 3000);
        }

        // Global state for advanced features
        let selectedStock = null;
        let virtualBalance = 50000;
        let portfolio = [];
        let isSessionActive = false;

        // Investment Simulator Functions
        function showInvestmentSimulator() {
            showScreen('investment-simulator');
        }

        function showHalalScreener() {
            showScreen('halal-screener');
        }

        function selectStock(symbol, name, price, change) {
            selectedStock = { symbol, name, price, change };
            
            // Remove previous selections
            document.querySelectorAll('.stock-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // Add selection to clicked item
            event.currentTarget.classList.add('selected');
            
            // Show trading form
            document.getElementById('tradingForm').style.display = 'block';
            document.getElementById('noSelection').style.display = 'none';
            
            // Update selected stock display
            document.getElementById('selectedStock').innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <strong>${symbol}</strong>
                        <div style="color: var(--light-gray); font-size: 0.9rem;">${name}</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-weight: bold;">${price}</div>
                        <div class="change ${change >= 0 ? 'positive' : 'negative'}">${change >= 0 ? '+' : ''}${change}%</div>
                    </div>
                </div>
            `;
            
            updateTotalCost();
        }

        function updateTotalCost() {
            if (!selectedStock) return;
            
            const quantity = parseInt(document.getElementById('quantity').value) || 0;
            const total = (selectedStock.price * quantity).toFixed(2);
            document.getElementById('totalCost').textContent = `${total}`;
        }

        function executeTrade() {
            if (!selectedStock) return;
            
            const orderType = document.getElementById('orderType').value;
            const quantity = parseInt(document.getElementById('quantity').value) || 0;
            const totalCost = selectedStock.price * quantity;
            
            if (quantity <= 0) {
                showNotification('Please enter a valid quantity', 'error');
                return;
            }
            
            if (orderType === 'buy' && totalCost > virtualBalance) {
                showNotification('Insufficient funds for this trade', 'error');
                return;
            }
            
            // Execute the trade
            if (orderType === 'buy') {
                virtualBalance -= totalCost;
                addToPortfolio(selectedStock, quantity);
                showNotification(`Successfully bought ${quantity} shares of ${selectedStock.symbol}`, 'success');
            } else {
                // Sell logic (simplified)
                virtualBalance += totalCost;
                showNotification(`Successfully sold ${quantity} shares of ${selectedStock.symbol}`, 'success');
            }
            
            // Update balance display
            document.getElementById('virtualBalance').textContent = virtualBalance.toFixed(0);
            updatePortfolioDisplay();
            
            // Reset form
            document.getElementById('quantity').value = 1;
            updateTotalCost();
        }

        function addToPortfolio(stock, quantity) {
            const existingPosition = portfolio.find(p => p.symbol === stock.symbol);
            if (existingPosition) {
                existingPosition.quantity += quantity;
                existingPosition.totalValue = existingPosition.quantity * stock.price;
            } else {
                portfolio.push({
                    symbol: stock.symbol,
                    name: stock.name,
                    quantity: quantity,
                    price: stock.price,
                    totalValue: quantity * stock.price
                });
            }
        }

        function updatePortfolioDisplay() {
            const portfolioList = document.getElementById('portfolioList');
            
            if (portfolio.length === 0) {
                portfolioList.innerHTML = `
                    <div class="empty-portfolio">
                        <i class="fas fa-chart-pie"></i>
                        <p>Your portfolio is empty. Start by buying some halal investments!</p>
                    </div>
                `;
                return;
            }
            
            portfolioList.innerHTML = portfolio.map(position => `
                <div class="stock-item">
                    <div class="stock-info">
                        <strong>${position.symbol}</strong>
                        <span>${position.name}</span>
                        <small>${position.quantity} shares</small>
                    </div>
                    <div class="stock-price">
                        <span class="price">${position.totalValue.toFixed(2)}</span>
                    </div>
                </div>
            `).join('');
        }

        // Halal Screener Functions
        function applyFilters() {
            showNotification('Filters applied successfully', 'success');
            // In a real app, this would filter the results
            const randomCount = Math.floor(Math.random() * 1000) + 2000;
            document.getElementById('resultsCount').textContent = `${randomCount.toLocaleString()} stocks found`;
        }

        // Live Coaching Session Functions
        function startLiveSession(clientName) {
            document.getElementById('sessionClientName').textContent = clientName;
            document.getElementById('clientVideoName').textContent = clientName;
            isSessionActive = true;
            showScreen('live-session');
            showNotification(`Starting live session with ${clientName}`, 'success');
        }

        function toggleMute() {
            const btn = document.getElementById('muteBtn');
            const icon = btn.querySelector('i');
            
            if (icon.classList.contains('fa-microphone')) {
                icon.className = 'fas fa-microphone-slash';
                btn.style.background = '#EF4444';
                showNotification('Microphone muted', 'info');
            } else {
                icon.className = 'fas fa-microphone';
                btn.style.background = 'var(--primary-blue)';
                showNotification('Microphone unmuted', 'info');
            }
        }

        function toggleVideo() {
            const btn = document.getElementById('videoBtn');
            const icon = btn.querySelector('i');
            
            if (icon.classList.contains('fa-video')) {
                icon.className = 'fas fa-video-slash';
                btn.style.background = '#EF4444';
                showNotification('Camera turned off', 'info');
            } else {
                icon.className = 'fas fa-video';
                btn.style.background = 'var(--primary-blue)';
                showNotification('Camera turned on', 'info');
            }
        }

        function toggleScreenShare() {
            const btn = document.getElementById('shareBtn');
            const text = btn.textContent.trim();
            
            if (text.includes('Share')) {
                btn.innerHTML = '<i class="fas fa-desktop"></i> Stop Sharing';
                btn.style.background = '#EF4444';
                showNotification('Screen sharing started', 'success');
            } else {
                btn.innerHTML = '<i class="fas fa-desktop"></i> Share Screen';
                btn.style.background = 'var(--accent-gold)';
                showNotification('Screen sharing stopped', 'info');
            }
        }

        function endSession() {
            if (confirm('Are you sure you want to end this coaching session?')) {
                isSessionActive = false;
                showScreen('coach-dashboard');
                showNotification('Coaching session ended', 'success');
            }
        }

        function showTool(toolName) {
            // Remove active class from all tabs and panels
            document.querySelectorAll('.tool-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tool-panel').forEach(panel => panel.classList.remove('active'));
            
            // Add active class to selected tab and panel
            document.getElementById(`${toolName}Tab`).classList.add('active');
            document.getElementById(`${toolName}Panel`).classList.add('active');
        }

        function selectOption(element, value) {
            // Remove selection from siblings
            element.parentNode.querySelectorAll('.option-card').forEach(card => {
                card.classList.remove('selected');
                card.setAttribute('aria-checked', 'false');
            });
            // Add selection to clicked element
            element.classList.add('selected');
            element.setAttribute('aria-checked', 'true');
            
            // Store value based on current step
            if (currentStep === 1) {
                userProfile.knowledgeLevel = value;
                validateStep1();
            } else if (currentStep === 3) {
                if (element.closest('.form-group').querySelector('label').textContent.includes('Risk')) {
                    userProfile.riskTolerance = value;
                } else if (element.closest('.form-group').querySelector('label').textContent.includes('Shariah')) {
                    userProfile.complianceLevel = value;
                }
                validateStep3();
            } else if (currentStep === 4) {
                userProfile.coachingFrequency = value;
                validateStep4();
            }
            
            // Save progress after selection
            saveProgress();
        }

        function startDemo(type) {
            if (!currentUser) {
                // If not logged in, go to login first
                showScreen('login');
                return;
            }
            
            if (type === 'individual') {
                showScreen('step1');
                currentStep = 1;
            } else if (type === 'coach') {
                showScreen('coach-dashboard');
            } else if (type === 'corporate') {
                showScreen('corporate-dashboard');
            }
        }

        function nextStep(step) {
            showScreen(`step${step}`);
            currentStep = step;
            updateProgress();
        }

        function prevStep(step) {
            showScreen(`step${step}`);
            currentStep = step;
            updateProgress();
        }

        function updateProgress() {
            const progressPercentage = (currentStep / 4) * 100;
            document.querySelectorAll('.progress-fill').forEach(fill => {
                fill.style.width = `${progressPercentage}%`;
            });
        }

        // Form interaction functions
        function selectOption(element, value) {
            // Remove selection from siblings
            element.parentNode.querySelectorAll('.option-card').forEach(card => {
                card.classList.remove('selected');
            });
            // Add selection to clicked element
            element.classList.add('selected');
            
            // Store value based on current step
            if (currentStep === 1) {
                userProfile.knowledgeLevel = value;
                validateStep1();
            } else if (currentStep === 3) {
                if (element.closest('.form-group').querySelector('label').textContent.includes('Risk')) {
                    userProfile.riskTolerance = value;
                } else if (element.closest('.form-group').querySelector('label').textContent.includes('Shariah')) {
                    userProfile.complianceLevel = value;
                }
                validateStep3();
            } else if (currentStep === 4) {
                userProfile.coachingFrequency = value;
                validateStep4();
            }
        }

        function toggleSelection(element, value) {
            element.classList.toggle('selected');
            
            if (currentStep === 2) {
                if (element.classList.contains('selected')) {
                    if (!userProfile.goals.includes(value)) {
                        userProfile.goals.push(value);
                    }
                } else {
                    userProfile.goals = userProfile.goals.filter(goal => goal !== value);
                }
                validateStep2();
            } else if (currentStep === 4) {
                if (element.classList.contains('selected')) {
                    if (!userProfile.communicationPrefs.includes(value)) {
                        userProfile.communicationPrefs.push(value);
                    }
                } else {
                    userProfile.communicationPrefs = userProfile.communicationPrefs.filter(pref => pref !== value);
                }
                validateStep4();
            }
        }

        // Validation functions
        function validateStep1() {
            const nameInput = document.getElementById('userName');
            const name = nameInput.value.trim();
            const hasKnowledge = userProfile.knowledgeLevel !== '';
            const nextBtn = document.getElementById('step1Next');
            
            // Real-time name validation
            validateField(nameInput, name.length >= 2, 'Name must be at least 2 characters');
            
            if (name && hasKnowledge) {
                userProfile.name = name;
                nextBtn.disabled = false;
            } else {
                nextBtn.disabled = true;
            }
        }

        function validateField(input, isValid, errorMessage) {
            // Remove existing validation classes and messages
            input.classList.remove('error', 'success');
            const existingError = input.parentNode.querySelector('.field-error');
            const existingSuccess = input.parentNode.querySelector('.field-success');
            if (existingError) existingError.remove();
            if (existingSuccess) existingSuccess.remove();
            
            if (input.value.trim() === '') {
                // Empty field - no validation styling
                return;
            }
            
            if (isValid) {
                input.classList.add('success');
                const successMsg = document.createElement('span');
                successMsg.className = 'field-success';
                successMsg.innerHTML = '<i class="fas fa-check"></i> Looks good!';
                input.parentNode.appendChild(successMsg);
            } else {
                input.classList.add('error');
                const errorMsg = document.createElement('span');
                errorMsg.className = 'field-error';
                errorMsg.innerHTML = `<i class="fas fa-exclamation-triangle"></i> ${errorMessage}`;
                input.parentNode.appendChild(errorMsg);
            }
        }

        function validateStep2() {
            const nextBtn = document.getElementById('step2Next');
            nextBtn.disabled = userProfile.goals.length === 0;
        }

        function validateStep3() {
            const monthlyAmount = document.getElementById('monthlyAmount').value;
            const hasRisk = userProfile.riskTolerance !== '';
            const hasCompliance = userProfile.complianceLevel !== '';
            const nextBtn = document.getElementById('step3Next');
            
            if (monthlyAmount && hasRisk && hasCompliance) {
                userProfile.monthlyAmount = monthlyAmount;
                nextBtn.disabled = false;
            } else {
                nextBtn.disabled = true;
            }
        }

        function validateStep4() {
            const hasFrequency = userProfile.coachingFrequency !== '';
            const hasComm = userProfile.communicationPrefs.length > 0;
            const nextBtn = document.getElementById('step4Next');
            
            nextBtn.disabled = !(hasFrequency && hasComm);
        }

        function completeOnboarding() {
            // Update dashboard with user name
            document.getElementById('dashboardName').textContent = userProfile.name || 'Ahmad';
            
            // Show completion message
            alert(`Welcome ${userProfile.name}! Your halal investment journey is about to begin. You'll now see your personalized dashboard.`);
            
            // Navigate to dashboard
            showScreen('dashboard');
        }

        // Event listeners
        document.getElementById('userName').addEventListener('input', validateStep1);
        document.getElementById('userName').addEventListener('blur', function() {
            const name = this.value.trim();
            validateField(this, name.length >= 2, 'Name must be at least 2 characters');
        });
        document.getElementById('monthlyAmount').addEventListener('change', validateStep3);
        
        // Investment simulator event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Quantity input listener for cost calculation
            const quantityInput = document.getElementById('quantity');
            if (quantityInput) {
                quantityInput.addEventListener('input', updateTotalCost);
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            showScreen('login');
            updateNavigation(false);
            
            // Check for saved progress
            loadProgress();
            
            // Set up connection monitoring
            window.addEventListener('online', handleConnectionChange);
            window.addEventListener('offline', handleConnectionChange);
            
            // Add Enter key support for login
            document.getElementById('loginEmail').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('loginPassword').focus();
                }
            });
            
            document.getElementById('loginPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleLogin();
                }
            });
            
            // Close tooltips when clicking elsewhere
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.help-btn')) {
                    document.querySelectorAll('.tooltip').forEach(tooltip => tooltip.remove());
                }
            });
            
            // Enhanced keyboard navigation
            document.addEventListener('keydown', function(e) {
                // Escape key closes notifications and tooltips
                if (e.key === 'Escape') {
                    document.querySelectorAll('.notification, .tooltip').forEach(el => el.remove());
                }
                
                // Tab navigation improvements
                if (e.key === 'Tab') {
                    // Add visible focus indicators
                    document.body.classList.add('keyboard-navigation');
                }
            });
            
            // Remove keyboard navigation class on mouse use
            document.addEventListener('mousedown', function() {
                document.body.classList.remove('keyboard-navigation');
            });
        });
    </script>
</body>
</html>
